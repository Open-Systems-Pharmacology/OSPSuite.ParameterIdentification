<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Confidence intervals • ospsuite.parameteridentification</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Confidence intervals">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ospsuite.parameteridentification</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.1.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Parameter identification workflow</h6></li>
    <li><a class="dropdown-item" href="../articles/user-guide.html">User guide</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Details</h6></li>
    <li><a class="dropdown-item" href="../articles/data-mapping.html">Data mapping and weights</a></li>
    <li><a class="dropdown-item" href="../articles/optimization-algorithms.html">Optimization algorithms</a></li>
    <li><a class="dropdown-item" href="../articles/confidence-intervals.html">Confidence intervals</a></li>
    <li><a class="dropdown-item" href="../articles/error-calculation.html">Error calculation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Open-Systems-Pharmacology/OSPSuite.ParameterIdentification/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Confidence intervals</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Open-Systems-Pharmacology/OSPSuite.ParameterIdentification/blob/main/vignettes/confidence-intervals.Rmd" class="external-link"><code>vignettes/confidence-intervals.Rmd</code></a></small>
      <div class="d-none name"><code>confidence-intervals.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>ospsuite.parameteridentification</code> package provides
tools to estimate model parameters by fitting simulations to observed
data. After the optimization step, confidence intervals (CIs) can be
used to assess the uncertainty of the estimated parameters and to
evaluate how robust the results are.</p>
<p>This vignette describes the available methods for confidence interval
estimation, explains how to configure and run them, and shows how to
inspect the results.</p>
</div>
<div class="section level2">
<h2 id="choosing-a-ci-method">Choosing a CI Method<a class="anchor" aria-label="anchor" href="#choosing-a-ci-method"></a>
</h2>
<ul>
<li><p><strong><code>hessian</code></strong> is the default method. It
estimates confidence intervals from the curvature of the objective
function at the optimum. This approach is fast and works well when the
problem is well-behaved and the objective function is approximately
quadratic.</p></li>
<li><p><strong><code>PL</code></strong> (profile likelihood) computes
confidence intervals by scanning the likelihood along each parameter. It
is more robust for parameters near bounds or in situations where the
likelihood is not well approximated by a quadratic shape, but it is
slower.</p></li>
<li>
<p><strong><code>bootstrap</code></strong> generates confidence
intervals by repeatedly resampling the observed data and re-fitting the
model. This method is robust and makes only minimal assumptions about
the likelihood, but it is computationally more intensive than the other
methods.</p>
<p>Resampling depends on the type of observed data:</p>
<ul>
<li>For individual datasets, new samples of individuals are drawn.<br>
</li>
<li>For aggregated datasets, resampling is based on Gaussian Process
Regression (GPR).<br>
</li>
<li>With both types of data, a mixed strategy is applied.<br>
</li>
<li>User-defined dataset weights are respected during resampling.</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="advanced-configuration-options">Advanced Configuration Options<a class="anchor" aria-label="anchor" href="#advanced-configuration-options"></a>
</h2>
<p>Each confidence interval method provides a predefined set of default
options. These defaults are available through the helper objects
<code>CIOptions_Hessian</code>, <code>CIOptions_PL</code>, and
<code>CIOptions_Bootstrap</code>.<br>
The corresponding object is assigned to
<code>piConfiguration$ciOptions</code> and individual fields can then be
modified as required.</p>
<div class="section level3">
<h3 id="explanation-of-options">Explanation of options<a class="anchor" aria-label="anchor" href="#explanation-of-options"></a>
</h3>
<p>Common options:<br>
- <code>epsilon</code>: numerical step size used in approximations<br>
- <code>confLevel</code>: confidence level (e.g. <code>0.95</code> for
95% confidence intervals)</p>
<p>Additional options for profile likelihood (PL):<br>
- <code>maxIter</code>: maximum number of iterations</p>
<p>Additional options for bootstrap:<br>
- <code>nBootstrap</code>: number of bootstrap resamples<br>
- <code>seed</code>: random seed for reproducibility</p>
<p>If no method is specified, the default is the
<strong><code>hessian</code></strong> method with its standard
options.</p>
</div>
<div class="section level3">
<h3 id="minimal-configuration-example">Minimal configuration example<a class="anchor" aria-label="anchor" href="#minimal-configuration-example"></a>
</h3>
<p>Configuration of confidence intervals is done through the
<code>PIConfiguration</code> object, which also holds all other settings
for parameter identification.<br>
The example below shows how the Hessian method is selected and its
default options adjusted:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">piConfiguration</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PIConfiguration.html">PIConfiguration</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select CI method</span></span>
<span><span class="va">piConfiguration</span><span class="op">$</span><span class="va">ciMethod</span>  <span class="op">&lt;-</span> <span class="st">"hessian"</span></span>
<span></span>
<span><span class="co"># assign default options and adjust if necessary</span></span>
<span><span class="va">piConfiguration</span><span class="op">$</span><span class="va">ciOptions</span> <span class="op">&lt;-</span> <span class="va">CIOptions_Hessian</span></span>
<span><span class="va">piConfiguration</span><span class="op">$</span><span class="va">ciOptions</span><span class="op">$</span><span class="va">confLevel</span> <span class="op">&lt;-</span> <span class="fl">0.95</span></span></code></pre></div>
<p>By default, confidence intervals are estimated immediately after each
optimization run (<code>autoEstimateCI = TRUE</code>). To disable this
behaviour and perform CI estimation later, set the flag to
<code>FALSE</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">piConfiguration</span><span class="op">$</span><span class="va">autoEstimateCI</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></code></pre></div>
<p>In this case, the optimization is executed first and CI estimation is
triggered explicitly when needed, for example to review results before
running the more time-consuming CI calculation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">piResult</span> <span class="op">&lt;-</span> <span class="va">piTask</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">piResult</span> <span class="op">&lt;-</span> <span class="va">piTask</span><span class="op">$</span><span class="fu">estimateCI</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="reading-ci-results">Reading CI results<a class="anchor" aria-label="anchor" href="#reading-ci-results"></a>
</h2>
<p>The printout of a <code>PIResult</code> object shows the main
outcomes of a parameter identification run, including parameter
estimates, standard deviations, coefficients of variation, and
confidence intervals (if available).</p>
<p>For programmatic access, the results of a PI run can be exported
either as a data frame or as a list:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span>  <span class="op">&lt;-</span> <span class="va">piResult</span><span class="op">$</span><span class="fu">toDataFrame</span><span class="op">(</span><span class="op">)</span>   <span class="co"># tidy table with estimates, sd, cv, lowerCI, upperCI, etc.</span></span>
<span><span class="va">lst</span> <span class="op">&lt;-</span> <span class="va">piResult</span><span class="op">$</span><span class="fu">toList</span><span class="op">(</span><span class="op">)</span>        <span class="co"># full details including cost information and CI-specific details</span></span></code></pre></div>
<p>The list output also contains a <code>ciDetails</code> entry where
method-specific information is stored:</p>
<ul>
<li>
<code>hessian</code>: Hessian matrix, covariance matrix,
eigenvalues, and correlation matrix<br>
</li>
<li>
<code>PL</code>: parameter history and likelihood thresholds<br>
</li>
<li>
<code>bootstrap</code>: bootstrap replicates, empirical confidence
bounds, and the seed used for resampling</li>
</ul>
</div>
<div class="section level2">
<h2 id="practical-tips">Practical tips<a class="anchor" aria-label="anchor" href="#practical-tips"></a>
</h2>
<ul>
<li><p>Start with the <code>hessian</code> method as it is the default
and runs quickly. If confidence intervals appear implausible (too wide,
asymmetric, or <code>NA</code>), repeat the analysis with
<code>bootstrap</code>.</p></li>
<li><p>When CI calculation fails, check parameter bounds, scaling
(<code>lin</code> or <code>log</code>), and residual weighting. Poorly
chosen settings in these areas often prevent reliable CI
estimation.</p></li>
<li><p>For <code>bootstrap</code>, begin with a small number of
resamples (for example 100–200) to test the setup, then increase as
needed. Always set a <code>seed</code> if reproducible results are
required.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://esqlabs.com/" class="external-link"><img src="https://esqlabs.github.io/esqlabsR/reference/figures/circles.png" style="max-width:33px">ESQlabs</a>, <a href="https://github.com/PavelBal" class="external-link">Pavel Balazki</a>, Rudi cre Engelke, <a href="https://github.com/svavil" class="external-link">Sergei Vavilov</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
